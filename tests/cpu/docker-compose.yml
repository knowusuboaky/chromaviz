services:
  chromaviz:
    image: ghcr.io/knowusuboaky/chromaviz:latest
    container_name: chromaviz
    ports: ["5000:5000"]
    environment:
      FLASK_SERVER_ENDPOINT: "http://0.0.0.0:5000"
      PUBLIC_HOST: "localhost"
      PUBLIC_PORT: "5000"
      CHROMA_MODE: "persistent"
      CHROMA_DB_PATH: "/data/chroma"
      EMBEDDINGS_MODE: "local"
      EMBEDDING_MODEL: "all-MiniLM-L6-v2"
      EMBEDDING_MODEL_PATH: "/app/models/all-MiniLM-L6-v2"
      EMBEDDING_CONTEXT_WINDOW: "1024"
      HF_HOME: "/app/models"
      AUTO_OPEN_BROWSER: "false"
    volumes:
      - ./chroma-data:/data/chroma
      - ./models:/app/models
    healthcheck:
      test: ["CMD", "curl", "-fsS", "http://127.0.0.1:5000/heartbeat"]
      interval: 30s
      timeout: 5s
      retries: 5
    restart: unless-stopped
